<!DOCTYPE html>
<html lang="it">
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $("head").load("../../components/head.html?123123");
    </script>
    <script>

        function make_editable(element) {
            $('#edit-popup').show();
            const popup = $('#popup-data');

            // popup.text("id is : " + element.attr('id'));
        }

        function register_clicks() {
            $(".table-row").dblclick(function (e) {
                make_editable($(this));
            });

            $("#edit-popup").click(function (e) {
                if (e.target === this) {
                    $(this).hide();
                }
            })

            $(".exit-button").click(function (e) {
                if (e.target === this) {
                    $("#edit-popup").hide();
                }
            })
        }

        $(document).ready(function () {
            $('#edit-popup').hide();

            const table_headers_strings = {
                STATUS: "requestState",
                PRODUCT: "productName",
                FLAVOUR: "productFlavour",
                NOTES: "notes",
                "REQUEST DATE": "requestDate",
                "DUE DATE": "dueDate",
                "CLOSED DATE": "terminationDate",
                "LAST COUNT": "lastCount",
                "PREVIOUS COUNT": "previousCount",
            };
            const table_query_data = {
                q_name: "office_requests",
                q_data: {},
            };
            const table_data_requester = new Requester(table_query_data, function (result) {
                table_maker(result.results, "request-table-container", table_headers_strings);
                register_clicks();
            });
            table_data_requester.query();


        });
    </script>
</head>
<body>
<main role="main" class="container">
    <div id="edit-popup" class="popup-container">
        <div class="popup">
            <div class="card-section exit-button-wrapper">
                <div class="card-header-title">Details</div>
                <div class="exit-button">&times;</div>
            </div>
            <div id="popup-data" class="card-section form-holder">
                <form id="edit-form" class="form" role="form">

                    <!-- Request info -->
                    <div class="form-group row">
                        <label for="req_id" class="col-1 col-form-label">Request Id</label>
                        <div class="col-11">
                            <div class="input-group">
                                <div class="input-group-prepend">X</div>
                                <input id="req_id" name="req_id" type="text" class="form-control" aria-describedby="req_idHelpBlock" required="required" readonly>
                            </div>
                            <span id="req_idHelpBlock" class="form-text text-muted">Assigned id to the current request</span>
                        </div>
                    </div>

                    <!-- Product info -->
                    <div class="row">
                        <label class="col-1 col-form-label">Product Info</label>

                        <div class="row col-11">
                            <div class="form-group col no-gutters">
                                <label class="col-12 col-form-label" for="prod_code">Product Code</label>
                                <div class="col-12">
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <div class="input-group-text"><i class="fa fa-barcode"></i></div>
                                        </div>
                                        <input id="prod_code" name="prod_code" type="text" class="form-control" aria-describedby="prod_codeHelpBlock" required="required" readonly>
                                    </div>
                                    <span id="prod_codeHelpBlock" class="form-text text-muted">Code assigned to the product</span>
                                </div>
                            </div>

                            <div class="form-group col no-gutters">
                                <label class="col-12 col-form-label" for="prod_name">Product Name</label>
                                <div class="col-12">
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <div class="input-group-text"><i class="fa fa-tag"></i></div>
                                        </div>
                                        <input id="prod_name" name="prod_name" type="text" class="form-control" aria-describedby="prod_nameHelpBlock" required="required" readonly>
                                    </div>
                                    <span id="prod_nameHelpBlock" class="form-text text-muted">Descriptive product name</span>
                                </div>
                            </div>

                            <div class="form-group col no-gutters">
                                <label for="prod_variant" class="col-12 col-form-label">Product flavour</label>
                                <div class="col-12">
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <div class="input-group-text">
                                                <i class="fa fa-archive"></i>
                                            </div>
                                        </div>
                                        <input id="prod_variant" name="prod_variant" type="text" class="form-control" aria-describedby="prod_variantHelpBlock" required="required" readonly>
                                    </div>
                                    <span id="prod_variantHelpBlock" class="form-text text-muted">The specific variant of this product</span>
                                </div>
                            </div>

                        </div>
                    </div>

                    <!-- Notes -->
                    <div class="form-group row">
                        <label for="notes" class="col-1 col-form-label">Notes</label>
                        <div class="col-11">
                            <textarea id="notes" name="notes" cols="20" rows="2" class="form-control" aria-describedby="notesHelpBlock"></textarea>
                            <span id="notesHelpBlock" class="form-text text-muted">Add notes to this request</span>
                        </div>
                    </div>

                    <!-- Dates -->
                    <div class="row">
                        <label class="col-1 col-form-label">Dates</label>
                        <div class="row col-11">

                            <div class="form-group col no-gutters">
                                <label for="date_due" class="col-12 col-form-label">Due Date</label>
                                <div class="col-12">
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <div class="input-group-text">
                                                <i class="fa fa-calendar"></i>
                                            </div>
                                        </div>
                                        <input id="date_due" name="date_due" type="date" class="form-control" aria-describedby="date_dueHelpBlock" required="required">
                                    </div>
                                    <span id="date_dueHelpBlock" class="form-text text-muted">Date before which the counting should be completed</span>
                                </div>
                            </div>

                            <div class="form-group row">
                                <label for="date_creation" class="col-12 col-form-label">Creation Date</label>
                                <div class="col-12">
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <div class="input-group-text">
                                                <i class="fa fa-calendar"></i>
                                            </div>
                                        </div>
                                        <input id="date_creation" name="date_creation" type="text" aria-describedby="date_creationHelpBlock" required="required" class="form-control" readonly>
                                    </div>
                                    <span id="date_creationHelpBlock" class="form-text text-muted">The creation date of the request</span>
                                </div>
                            </div>

                        </div>
                    </div>

                    <!-- Counts -->
                    <div class="row">
                        <label class="col-1 col-form-label">Counts</label>
                        <div class="form-group col no-gutters">
                            <label for="count_previous" class="col-12 col-form-label">Previous Count</label>
                            <div class="col-12">
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <div class="input-group-text">
                                            <i class="fa fa-bar-chart-o"></i>
                                        </div>
                                    </div>
                                    <input id="count_previous" name="count_previous" type="text" class="form-control" aria-describedby="count_previousHelpBlock" readonly>
                                </div>
                                <span id="count_previousHelpBlock" class="form-text text-muted">Automatically generated previous count</span>
                            </div>
                        </div>
                        <div class="form-group col no-gutters">
                            <label for="count_last" class="col-12 col-form-label">Last Count</label>
                            <div class="col-12">
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <div class="input-group-text">
                                            <i class="fa fa-refresh"></i>
                                        </div>
                                    </div>
                                    <input id="count_last" name="count_last" type="text" class="form-control" readonly>
                                </div>
                                <span id="count_lastHelpBlock" class="form-text text-muted">Latest count created.</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-group row col-12 justify-content-center">
                        <button name="submit" type="submit" class="btn btn-primary">Create</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="header test-class">Office</div>

    <div class="sub-header">
        <div class="dropdown">
            <button class="styled-btn dropdown-toggle" type="button" id="btn-filters" data-bs-toggle="dropdown" aria-expanded="false">
                Filters
            </button>
            <ul class="dropdown-menu" aria-labelledby="btn-filters">
                <li><a class="dropdown-item" href="#">Most Recent</a></li>
                <li><a class="dropdown-item" href="#">Oldest</a></li>
                <li><a class="dropdown-item" href="#">Upcoming due date</a></li>
                <li><hr class="dropdown-divider" /></li>
                <li><a class="dropdown-item" href="#">Separated link</a></li>
                <li>
                    <a class="dropdown-item" href="#">
                        <label class="form-check-label" for="flexCheckChecked">
                            <input class="" type="checkbox" value="showClosed" id="flexCheckChecked" />
                            Show closed
                        </label>
                    </a>
                </li>
            </ul>
        </div>

        <button type="button" id="btn-add-request" class="styled-btn">Add Request</button>
    </div>

    <div class="request-table" id="request-table-container"></div>
</main>
</body>
</html>
